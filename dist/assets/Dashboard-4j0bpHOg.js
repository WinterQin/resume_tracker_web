import{h as R,g as v,s as z,j as N,o as y,k as a,n as s,w as t,r as d,p as V,t as T,v as p,c as M,x as O,m as f,y as w,z as $,A as H}from"./vendor-C-QY2w59.js";import{a as b,f as I}from"./date-Fj5DctZ9.js";import{A as L}from"./AppHeader-Br-H0n0y.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-43yu0djy.js";const q={class:"app-container"},G={class:"dashboard-container"},J={class:"stat-value"},K={class:"stat-value"},P={class:"stat-value"},Q={class:"stat-value"},U={class:"card-header"},W={__name:"Dashboard",setup(Y){const r=R({total:0,written:0,interview:0,accepted:0,rejected:0}),g=v([]),m=v(null);let u=null;const h=v(!1),k=n=>({submitted:"primary",written:"warning",interview:"",accepted:"success",rejected:"danger"})[n]||"info",A=n=>n==="interview"?{backgroundColor:"#A020F0",color:"#ffffff"}:{},C=n=>({submitted:"已投递",written:"笔试中",interview:"面试中",accepted:"已录用",rejected:"已拒绝"})[n]||n,S=async()=>{try{h.value=!0;const e=(await b.getRecentApplications()).applications||[];g.value=e;const l=(await b.getApplications()).applications||[];r.total=l.length,r.written=l.filter(o=>o.status==="written").length,r.interview=l.filter(o=>o.status==="interview").length,r.accepted=l.filter(o=>o.status==="accepted").length,r.rejected=l.filter(o=>o.status==="rejected").length,x(l)}catch(n){console.error("获取数据失败:",n),V.error("获取数据失败，请刷新重试")}finally{h.value=!1}},x=n=>{if(!m.value)return;const e={submitted:0,written:0,interview:0,accepted:0,rejected:0};n.forEach(l=>{l.status in e&&e[l.status]++});const c={tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"50%",data:[{value:e.submitted,name:"已投递",itemStyle:{color:"#409EFF"}},{value:e.written,name:"笔试中",itemStyle:{color:"#E6A23C"}},{value:e.interview,name:"面试中",itemStyle:{color:"#A020F0"}},{value:e.accepted,name:"已录用",itemStyle:{color:"#67C23A"}},{value:e.rejected,name:"已拒绝",itemStyle:{color:"#F56C6C"}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};u||(u=T(m.value)),u.setOption(c)};return z(()=>{S(),window.addEventListener("resize",()=>{u==null||u.resize()})}),(n,e)=>{const c=d("el-card"),l=d("el-col"),o=d("el-row"),j=d("el-button"),_=d("el-table-column"),E=d("el-icon"),B=d("el-link"),D=d("el-tag"),F=d("el-table");return y(),N("div",q,[a(L),s("div",G,[a(o,{gutter:12},{default:t(()=>[a(l,{span:14},{default:t(()=>[a(o,{gutter:12},{default:t(()=>[a(l,{span:12},{default:t(()=>[a(c,{class:"stat-card"},{header:t(()=>e[1]||(e[1]=[s("div",{class:"card-header"},[s("span",null,"总申请数")],-1)])),default:t(()=>[s("div",J,p(r.total),1)]),_:1})]),_:1}),a(l,{span:12},{default:t(()=>[a(c,{class:"stat-card"},{header:t(()=>e[2]||(e[2]=[s("div",{class:"card-header"},[s("span",null,"面试/笔试中")],-1)])),default:t(()=>[s("div",K,p(r.interview+r.written),1)]),_:1})]),_:1})]),_:1}),a(o,{gutter:12,class:"mt-12"},{default:t(()=>[a(l,{span:12},{default:t(()=>[a(c,{class:"stat-card"},{header:t(()=>e[3]||(e[3]=[s("div",{class:"card-header"},[s("span",null,"已录用")],-1)])),default:t(()=>[s("div",P,p(r.accepted),1)]),_:1})]),_:1}),a(l,{span:12},{default:t(()=>[a(c,{class:"stat-card"},{header:t(()=>e[4]||(e[4]=[s("div",{class:"card-header"},[s("span",null,"已拒绝")],-1)])),default:t(()=>[s("div",Q,p(r.rejected),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(l,{span:10},{default:t(()=>[a(c,{class:"chart-card"},{header:t(()=>e[5]||(e[5]=[s("div",{class:"card-header"},[s("span",null,"状态分布")],-1)])),default:t(()=>[s("div",{ref_key:"chartRef",ref:m,style:{height:"300px"}},null,512)]),_:1})]),_:1})]),_:1}),a(o,{class:"mt-12"},{default:t(()=>[a(l,{span:24},{default:t(()=>[a(c,null,{header:t(()=>[s("div",U,[e[7]||(e[7]=s("span",null,"最近申请",-1)),a(j,{text:"",onClick:e[0]||(e[0]=i=>n.$router.push("/applications"))},{default:t(()=>e[6]||(e[6]=[f("查看全部")])),_:1})])]),default:t(()=>[a(F,{data:g.value,style:{width:"100%"},align:"right"},{default:t(()=>[a(_,{prop:"company",label:"公司",width:"220",align:"right"}),a(_,{prop:"position",label:"职位",width:"220",align:"right"}),a(_,{prop:"apply_url",label:"投递网址",align:"center"},{default:t(({row:i})=>[i.event_link?(y(),M(B,{key:0,type:"primary",href:i.event_link,target:"_blank",underline:!1},{default:t(()=>[a(E,null,{default:t(()=>[a(w($))]),_:1}),f(" "+p(i.event_link),1)]),_:2},1032,["href"])):O("",!0)]),_:1}),a(_,{prop:"status",label:"状态",width:"120",align:"left"},{default:t(({row:i})=>[a(D,{type:k(i.status),style:H(A(i.status))},{default:t(()=>[f(p(C(i.status)),1)]),_:2},1032,["type","style"])]),_:1}),a(_,{prop:"apply_date",label:"申请时间",width:"120",align:"left"},{default:t(({row:i})=>[f(p(w(I)(i.apply_date)),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})])])}}},lt=X(W,[["__scopeId","data-v-c6ec87aa"]]);export{lt as default};
